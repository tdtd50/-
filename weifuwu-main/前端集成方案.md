# ğŸ¨ å‰ç«¯é›†æˆæ–¹æ¡ˆ

## ğŸ“ æ¨èçš„ç›®å½•ç»“æ„

```
ecommerce-system/                    # é¡¹ç›®æ ¹ç›®å½•
â”œâ”€â”€ frontend/                        # å‰ç«¯é¡¹ç›® â† æ”¾è¿™é‡Œï¼
â”‚   â”œâ”€â”€ index.html                   # ä¸»é¡µé¢
â”‚   â”œâ”€â”€ main.js                      # ä¸»é€»è¾‘
â”‚   â”œâ”€â”€ api.js                       # API è°ƒç”¨
â”‚   â”œâ”€â”€ css/                         # æ ·å¼æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
â”‚   â”‚   â””â”€â”€ style.css
â”‚   â””â”€â”€ assets/                      # é™æ€èµ„æºï¼ˆå¯é€‰ï¼‰
â”‚       â””â”€â”€ images/
â”œâ”€â”€ gateway-service/                 # ç½‘å…³æœåŠ¡
â”œâ”€â”€ user-service/                    # ç”¨æˆ·æœåŠ¡
â”œâ”€â”€ product-service/                 # äº§å“æœåŠ¡
â”œâ”€â”€ order-service/                   # è®¢å•æœåŠ¡
â”œâ”€â”€ docker-compose.yml
â””â”€â”€ pom.xml
```

## ğŸš€ ä¸‰ç§éƒ¨ç½²æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1ï¼šç‹¬ç«‹éƒ¨ç½²ï¼ˆæ¨èï¼‰â­

**ä¼˜ç‚¹**ï¼š
- å‰åç«¯å®Œå…¨åˆ†ç¦»
- å¼€å‘è°ƒè¯•æ–¹ä¾¿
- å¯ä»¥ä½¿ç”¨ä»»ä½•å‰ç«¯æœåŠ¡å™¨

**æ­¥éª¤**ï¼š
1. å°† `frontend/` æ–‡ä»¶å¤¹æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•
2. ä½¿ç”¨ç®€å•çš„ HTTP æœåŠ¡å™¨è¿è¡Œå‰ç«¯
3. å‰ç«¯é€šè¿‡ Gateway (8080) è®¿é—®åç«¯ API

**å¯åŠ¨æ–¹å¼**ï¼š
```bash
# åœ¨ frontend ç›®å½•ä¸‹
python -m http.server 3000
# æˆ–
npx http-server -p 3000
```

è®¿é—®ï¼šhttp://localhost:3000

---

### æ–¹æ¡ˆ 2ï¼šé›†æˆåˆ° Gatewayï¼ˆç”Ÿäº§æ¨èï¼‰â­â­â­

**ä¼˜ç‚¹**ï¼š
- ç»Ÿä¸€å…¥å£ï¼Œæ— è·¨åŸŸé—®é¢˜
- ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ
- å‰ç«¯èµ„æºç”± Gateway æä¾›

**æ­¥éª¤**ï¼š
1. å°†å‰ç«¯æ–‡ä»¶æ”¾åˆ° `gateway-service/src/main/resources/static/`
2. Gateway è‡ªåŠ¨æä¾›é™æ€èµ„æºæœåŠ¡
3. è®¿é—® http://localhost:8080 å³å¯

**ç›®å½•ç»“æ„**ï¼š
```
gateway-service/
â””â”€â”€ src/
    â””â”€â”€ main/
        â””â”€â”€ resources/
            â”œâ”€â”€ application.yml
            â””â”€â”€ static/              # é™æ€èµ„æºç›®å½•
                â”œâ”€â”€ index.html
                â”œâ”€â”€ main.js
                â”œâ”€â”€ api.js
                â””â”€â”€ css/
                    â””â”€â”€ style.css
```

---

### æ–¹æ¡ˆ 3ï¼šä½¿ç”¨ Nginx åå‘ä»£ç†ï¼ˆä¼ä¸šçº§ï¼‰â­â­â­â­

**ä¼˜ç‚¹**ï¼š
- é«˜æ€§èƒ½
- çµæ´»çš„è·¯ç”±é…ç½®
- é€‚åˆå¤§å‹é¡¹ç›®

**æ­¥éª¤**ï¼š
1. å‰ç«¯æ”¾åœ¨ `frontend/` ç›®å½•
2. ä½¿ç”¨ Nginx æä¾›å‰ç«¯æœåŠ¡
3. Nginx åå‘ä»£ç†åç«¯ API

## ğŸ“ è¯¦ç»†å®æ–½æ­¥éª¤

### æ–¹æ¡ˆ 1 å®æ–½ï¼ˆæœ€ç®€å•ï¼‰

#### 1. åˆ›å»ºå‰ç«¯ç›®å½•
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹
mkdir frontend
```

#### 2. æ”¾ç½®å‰ç«¯æ–‡ä»¶
```
frontend/
â”œâ”€â”€ index.html
â”œâ”€â”€ main.js
â””â”€â”€ api.js
```

#### 3. ä¿®æ”¹ api.js é…ç½®
```javascript
// api.js
const API_BASE_URL = 'http://localhost:8080'; // Gateway åœ°å€

// ç”¨æˆ· API
const userAPI = {
    list: () => fetch(`${API_BASE_URL}/api/v1/users`).then(r => r.json()),
    create: (data) => fetch(`${API_BASE_URL}/api/v1/users`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
    }).then(r => r.json()),
    get: (id) => fetch(`${API_BASE_URL}/api/v1/users/${id}`).then(r => r.json())
};

// äº§å“ API
const productAPI = {
    list: () => fetch(`${API_BASE_URL}/api/v1/products`).then(r => r.json()),
    create: (data) => fetch(`${API_BASE_URL}/api/v1/products`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
    }).then(r => r.json()),
    get: (id) => fetch(`${API_BASE_URL}/api/v1/products/${id}`).then(r => r.json())
};

// è®¢å• API
const orderAPI = {
    create: (data) => fetch(`${API_BASE_URL}/api/v1/orders`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
    }).then(r => r.json()),
    get: (id) => fetch(`${API_BASE_URL}/api/v1/orders/${id}`).then(r => r.json())
};
```

#### 4. å¯åŠ¨å‰ç«¯æœåŠ¡
```bash
cd frontend

# æ–¹å¼ 1: Python
python -m http.server 3000

# æ–¹å¼ 2: Node.js
npx http-server -p 3000 -c-1

# æ–¹å¼ 3: PHP
php -S localhost:3000
```

#### 5. è®¿é—®
æ‰“å¼€æµè§ˆå™¨ï¼šhttp://localhost:3000

---

### æ–¹æ¡ˆ 2 å®æ–½ï¼ˆç”Ÿäº§æ¨èï¼‰

#### 1. åˆ›å»ºé™æ€èµ„æºç›®å½•
```bash
mkdir -p gateway-service/src/main/resources/static
```

#### 2. å¤åˆ¶å‰ç«¯æ–‡ä»¶
```bash
cp frontend/* gateway-service/src/main/resources/static/
```

#### 3. ä¿®æ”¹ api.js
```javascript
// ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œå› ä¸ºå‰ç«¯å’Œåç«¯åœ¨åŒä¸€ä¸ªåŸŸåä¸‹
const API_BASE_URL = ''; // ç©ºå­—ç¬¦ä¸²è¡¨ç¤ºå½“å‰åŸŸå

const userAPI = {
    list: () => fetch(`/api/v1/users`).then(r => r.json()),
    // ...
};
```

#### 4. æ›´æ–° Gateway é…ç½®ï¼ˆå¯é€‰ï¼‰
å¦‚æœéœ€è¦è‡ªå®šä¹‰é™æ€èµ„æºè·¯å¾„ï¼Œå¯ä»¥åœ¨ `gateway-service/src/main/resources/application.yml` ä¸­æ·»åŠ ï¼š

```yaml
spring:
  web:
    resources:
      static-locations: classpath:/static/
```

#### 5. é‡å¯ Gateway
```bash
# åœ¨ IDEA ä¸­åœæ­¢å¹¶é‡æ–°å¯åŠ¨ gateway-service
```

#### 6. è®¿é—®
æ‰“å¼€æµè§ˆå™¨ï¼šhttp://localhost:8080

---

### æ–¹æ¡ˆ 3 å®æ–½ï¼ˆNginxï¼‰

#### 1. åˆ›å»º Nginx é…ç½®
åˆ›å»º `nginx.conf`ï¼š

```nginx
server {
    listen 80;
    server_name localhost;

    # å‰ç«¯é™æ€èµ„æº
    location / {
        root /path/to/frontend;
        index index.html;
        try_files $uri $uri/ /index.html;
    }

    # ä»£ç†åç«¯ API
    location /api/ {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

#### 2. ä½¿ç”¨ Docker Compose é›†æˆ
æ›´æ–° `docker-compose.yml`ï¼š

```yaml
services:
  # ... ç°æœ‰æœåŠ¡ ...

  nginx:
    image: nginx:alpine
    container_name: nginx
    ports:
      - "80:80"
    volumes:
      - ./frontend:/usr/share/nginx/html
      - ./nginx.conf:/etc/nginx/conf.d/default.conf
    depends_on:
      - gateway-service
```

## ğŸ”§ è·¨åŸŸé…ç½®ï¼ˆå¦‚æœéœ€è¦ï¼‰

å¦‚æœä½¿ç”¨æ–¹æ¡ˆ 1ï¼ˆç‹¬ç«‹éƒ¨ç½²ï¼‰ï¼Œéœ€è¦åœ¨ Gateway ä¸­é…ç½® CORSï¼š

### åœ¨ gateway-service ä¸­æ·»åŠ  CORS é…ç½®

åˆ›å»º `gateway-service/src/main/java/com/example/gateway/config/CorsConfig.java`ï¼š

```java
package com.example.gateway.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.cors.CorsConfiguration;
import org.springframework.web.cors.reactive.CorsWebFilter;
import org.springframework.web.cors.reactive.UrlBasedCorsConfigurationSource;

@Configuration
public class CorsConfig {

    @Bean
    public CorsWebFilter corsWebFilter() {
        CorsConfiguration config = new CorsConfiguration();
        config.addAllowedOrigin("http://localhost:3000"); // å‰ç«¯åœ°å€
        config.addAllowedMethod("*");
        config.addAllowedHeader("*");
        config.setAllowCredentials(true);

        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        source.registerCorsConfiguration("/**", config);

        return new CorsWebFilter(source);
    }
}
```

## ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”

| ç‰¹æ€§ | æ–¹æ¡ˆ1 ç‹¬ç«‹éƒ¨ç½² | æ–¹æ¡ˆ2 é›†æˆGateway | æ–¹æ¡ˆ3 Nginx |
|------|--------------|-----------------|------------|
| å¼€å‘ä¾¿åˆ©æ€§ | â­â­â­â­â­ | â­â­â­ | â­â­ |
| ç”Ÿäº§é€‚ç”¨æ€§ | â­â­ | â­â­â­â­ | â­â­â­â­â­ |
| è·¨åŸŸé—®é¢˜ | éœ€è¦é…ç½® | æ—  | æ—  |
| éƒ¨ç½²å¤æ‚åº¦ | ä½ | ä½ | ä¸­ |
| æ€§èƒ½ | ä¸­ | ä¸­ | é«˜ |
| æ¨èåœºæ™¯ | å¼€å‘è°ƒè¯• | ä¸­å°å‹é¡¹ç›® | å¤§å‹é¡¹ç›® |

## ğŸ¯ æˆ‘çš„æ¨è

### å¼€å‘é˜¶æ®µ
ä½¿ç”¨ **æ–¹æ¡ˆ 1**ï¼š
- å‰ç«¯æ”¾åœ¨ `frontend/` ç›®å½•
- ä½¿ç”¨ `python -m http.server 3000` å¿«é€Ÿå¯åŠ¨
- åœ¨ Gateway ä¸­é…ç½® CORS

### ç”Ÿäº§éƒ¨ç½²
ä½¿ç”¨ **æ–¹æ¡ˆ 2**ï¼š
- å‰ç«¯æ‰“åŒ…åæ”¾åˆ° `gateway-service/src/main/resources/static/`
- é€šè¿‡ Gateway ç»Ÿä¸€æä¾›æœåŠ¡
- æ— è·¨åŸŸé—®é¢˜ï¼Œé…ç½®ç®€å•

## ğŸ“ ä¸‹ä¸€æ­¥æ“ä½œ

1. **é€‰æ‹©æ–¹æ¡ˆ**ï¼šæ ¹æ®ä½ çš„éœ€æ±‚é€‰æ‹©ä¸Šè¿°æ–¹æ¡ˆä¹‹ä¸€
2. **åˆ›å»ºç›®å½•**ï¼šæŒ‰ç…§æ–¹æ¡ˆåˆ›å»ºç›¸åº”çš„ç›®å½•ç»“æ„
3. **æ”¾ç½®æ–‡ä»¶**ï¼šå°†ä½ çš„å‰ç«¯æ–‡ä»¶æ”¾åˆ°æŒ‡å®šä½ç½®
4. **ä¿®æ”¹é…ç½®**ï¼šæ ¹æ®æ–¹æ¡ˆä¿®æ”¹ API åœ°å€å’Œç›¸å…³é…ç½®
5. **å¯åŠ¨æµ‹è¯•**ï¼šå¯åŠ¨å‰ç«¯æœåŠ¡å¹¶æµ‹è¯•åŠŸèƒ½

## ğŸ‰ å®Œæˆåçš„è®¿é—®æ–¹å¼

- **æ–¹æ¡ˆ 1**: http://localhost:3000 (å‰ç«¯) + http://localhost:8080 (åç«¯)
- **æ–¹æ¡ˆ 2**: http://localhost:8080 (å‰åç«¯ç»Ÿä¸€)
- **æ–¹æ¡ˆ 3**: http://localhost (Nginx ç»Ÿä¸€å…¥å£)

---

**è¯·å‘Šè¯‰æˆ‘ä½ æƒ³ä½¿ç”¨å“ªä¸ªæ–¹æ¡ˆï¼Œæˆ‘ä¼šå¸®ä½ å®Œæˆå…·ä½“çš„é…ç½®ï¼** ğŸ˜Š
